---
title: "Atmospheric CO2"
author: "Ben Bond-Lamberty and Corinne Hartin"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Atmospheric CO2}
  %\VignetteEngine{knitr::rmarkdown}
  %\usepackage[utf8]{inputenc}
---

One common use for CMIP5 data, and the `RCMIP5` package, is to extract the global mean of some variable of interest for particular models, experiments, and/or ensembles. Here we give an example of this, computing the global mean CO2 value by year.

## Make sure the required data are present

As the package documentation notes (see e.g. http://gitcom.com/JGCRI/RCMIP) you first have to download the necessary from an Earth System Grid Federation node; RCMIP5 won't do this for you. Assuming this step is complete, then, we check to make sure all the data we'll need are present. First load information about all the CMIP5 files available:
```
library(RCMIP5)
c5files <- getFileInfo("~/location/of/cmip5/files/"")
```

By default, `getFileInfo` will recursively scan the entire directory tree and return a data frame containing the following information:

- File path
- File name
- Variable name
- Domain
- Model
- Experiment (typically historical, rcp45, rcp85, etc.)
- Ensemble
- Time^[Unless it's an 'fx' (fixed) domain file, with no time dimension.]
- Size (kb)

We're interested in the CO2 files; more specifically, we want to know whether all the necessary files have been downloaded.

```
co2files <- subset(c5files, variable=="co2")
co2filechk <- checkTimePeriod(co2files)
co2filechk
```

## Load the data


```
co2 <- loadCMIP5("co2", "CMCC-CESM", "co2", path="~/location/of/cmip5/files/")
```

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
